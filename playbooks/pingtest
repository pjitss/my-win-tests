#- name: ping test
#  win_ping:
#  register: ping_status
#- debug: var=ping_status

- name: Retrieve active network interface details
  win_shell: |
    $nic = Get-NetAdapter | Where-Object {$_.Status -eq 'Up'} | Select-Object -First 1
    Write-Output $nic.Name
  register: active_nic
- debug: var=active_nic


